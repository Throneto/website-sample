# å¢é‡å¼åšå®¢ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸ“– ä»€ä¹ˆæ˜¯å¢é‡å¼åšå®¢ç³»ç»Ÿï¼Ÿ

å¢é‡å¼åšå®¢ç³»ç»Ÿå°†æ–‡ç« å­˜å‚¨åœ¨å¤šä¸ª JSON æ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯å•ä¸€çš„å¤§æ–‡ä»¶ã€‚æ¯æ¬¡æ·»åŠ æ–°æ–‡ç« æ—¶ï¼Œåªç”Ÿæˆä¸€ä¸ªæ–°çš„ JSON æ–‡ä»¶ï¼Œä¸ä¼šè¦†ç›–ç°æœ‰æ•°æ®ã€‚

## âœ¨ ä¸»è¦ä¼˜åŠ¿

| ç‰¹æ€§ | ä¼ ç»Ÿæ–¹å¼ | å¢é‡æ–¹å¼ |
|------|---------|---------|
| æ•°æ®å®‰å…¨ | âš ï¸ æ¯æ¬¡è¦†ç›–æ•´ä¸ªæ–‡ä»¶ | âœ… ç”Ÿæˆæ–°æ–‡ä»¶ï¼Œä¸è¦†ç›– |
| å¤„ç†é€Ÿåº¦ | âš ï¸ æ¯æ¬¡å¤„ç†æ‰€æœ‰æ–‡ç«  | âœ… åªå¤„ç†æ–°å¢/ä¿®æ”¹ |
| æ–‡ä»¶å¤§å° | âš ï¸ å•æ–‡ä»¶è¶Šæ¥è¶Šå¤§ | âœ… å¤šä¸ªå°æ–‡ä»¶ |
| ç‰ˆæœ¬æ§åˆ¶ | âš ï¸ éš¾ä»¥è¿½è¸ªå˜åŒ– | âœ… æ¯æ¬¡æ›´æ–°ç‹¬ç«‹è®°å½• |
| å›æ»šèƒ½åŠ› | âš ï¸ éœ€è¦æ‰‹åŠ¨å¤‡ä»½ | âœ… åˆ é™¤æ–‡ä»¶å³å¯å›æ»š |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ¬¡ä½¿ç”¨

1. **åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ç¯‡æ–‡ç« **

åˆ›å»ºæ–‡ä»¶ `posts/my-first-article.md`ï¼š

```markdown
---
title: æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢
category: technology
tags: åšå®¢, å…¥é—¨, Markdown
icon: ğŸš€
excerpt: è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ï¼Œä»‹ç»å¦‚ä½•ä½¿ç”¨å¢é‡å¼åšå®¢ç³»ç»Ÿã€‚
featured: true
---

# æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢

è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼

## ä¸ºä»€ä¹ˆå†™åšå®¢ï¼Ÿ

å†™åšå®¢å¯ä»¥ï¼š
- è®°å½•å­¦ä¹ è¿‡ç¨‹
- åˆ†äº«çŸ¥è¯†ç»éªŒ
- æå‡å†™ä½œèƒ½åŠ›

## ä¸‹ä¸€æ­¥

æ¥ä¸‹æ¥æˆ‘ä¼šåˆ†äº«æ›´å¤šå†…å®¹...
```

2. **è¿è¡Œè½¬æ¢è„šæœ¬**

```bash
node tools/md-to-json-incremental.js
```

3. **æŸ¥çœ‹ç”Ÿæˆçš„æ–‡ä»¶**

```
data/
â”œâ”€â”€ articles-index.json          # ç´¢å¼•æ–‡ä»¶
â”œâ”€â”€ articles/
â”‚   â””â”€â”€ articles-2025-01-20.json # æ‚¨çš„ç¬¬ä¸€ç¯‡æ–‡ç« 
â””â”€â”€ .processed-files.json         # å·²å¤„ç†æ–‡ä»¶è®°å½•
```

4. **åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹**

æ‰“å¼€åšå®¢é¡µé¢ï¼Œæ‚¨çš„æ–°æ–‡ç« å·²ç»å‡ºç°äº†ï¼

### æ·»åŠ æ›´å¤šæ–‡ç« 

1. **åˆ›å»ºæ–°æ–‡ç« **

`posts/second-article.md`ï¼š

```markdown
---
title: ç¬¬äºŒç¯‡æ–‡ç« 
category: design
tags: è®¾è®¡, UI, ç”¨æˆ·ä½“éªŒ
icon: ğŸ¨
---

# è®¾è®¡çš„è‰ºæœ¯

è¿™æ˜¯æˆ‘çš„ç¬¬äºŒç¯‡æ–‡ç« ...
```

2. **å†æ¬¡è¿è¡Œè„šæœ¬**

```bash
node tools/md-to-json-incremental.js
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Markdown å¢é‡è½¬æ¢å·¥å…· v2.0               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ å‘ç° 2 ä¸ª Markdown æ–‡ä»¶

ğŸ“ éœ€è¦å¤„ç† 1 ä¸ªæ–‡ä»¶:

  å¤„ç†: second-article.md
    âœ“ ç¬¬äºŒç¯‡æ–‡ç«  (è®¾è®¡)

âœ“ ç”Ÿæˆæ–°æ–‡ä»¶: articles-2025-01-20-123456.json
âœ“ æ›´æ–°ç´¢å¼•æ–‡ä»¶

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            è½¬æ¢å®Œæˆï¼                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  æ–°å¢æ–‡ç« : 1 ç¯‡
  æ–‡ç« æ€»æ•°: 2 ç¯‡
  JSON æ–‡ä»¶æ•°: 2 ä¸ª
```

æ³¨æ„ï¼šè„šæœ¬åªå¤„ç†äº†æ–°å¢çš„ `second-article.md`ï¼Œç¬¬ä¸€ç¯‡æ–‡ç« è¢«è·³è¿‡äº†ï¼

## ğŸ“ æ–‡ä»¶ç»“æ„è¯¦è§£

### ç´¢å¼•æ–‡ä»¶ (`articles-index.json`)

```json
{
  "version": "1.0",
  "lastUpdate": "2025-01-20T10:30:00.000Z",
  "totalArticles": 2,
  "files": [
    {
      "filename": "articles-2025-01-20.json",
      "date": "2025-01-20",
      "count": 1,
      "createdAt": "2025-01-20T10:00:00.000Z"
    },
    {
      "filename": "articles-2025-01-20-123456.json",
      "date": "2025-01-20",
      "count": 1,
      "createdAt": "2025-01-20T10:30:00.000Z"
    }
  ]
}
```

**å­—æ®µè¯´æ˜ï¼š**
- `version`: ç´¢å¼•æ–‡ä»¶æ ¼å¼ç‰ˆæœ¬
- `lastUpdate`: æœ€åæ›´æ–°æ—¶é—´
- `totalArticles`: æ–‡ç« æ€»æ•°
- `files`: æ‰€æœ‰æ–‡ç« æ–‡ä»¶åˆ—è¡¨ï¼ˆæŒ‰æ—¥æœŸå€’åºï¼‰

### æ–‡ç« æ–‡ä»¶ (`articles/articles-YYYY-MM-DD.json`)

```json
{
  "generatedAt": "2025-01-20T10:00:00.000Z",
  "date": "2025-01-20",
  "count": 1,
  "articles": [
    {
      "id": 1,
      "title": "æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢",
      "excerpt": "è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ...",
      "content": "# æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢\n\n...",
      "category": "æŠ€æœ¯",
      "tags": ["åšå®¢", "å…¥é—¨", "Markdown"],
      "icon": "ğŸš€",
      "publishDate": "2025-01-20",
      "readTime": "3åˆ†é’Ÿ",
      "views": 0,
      "likes": 0,
      "featured": true,
      "slug": "my-first-article",
      "sourceFile": "my-first-article.md"
    }
  ]
}
```

### å·²å¤„ç†æ–‡ä»¶è®°å½• (`.processed-files.json`)

```json
{
  "d:\\posts\\my-first-article.md": "d:\\posts\\my-first-article.md:1705747200000:1234",
  "d:\\posts\\second-article.md": "d:\\posts\\second-article.md:1705750800000:987"
}
```

**æ ¼å¼ï¼š** `æ–‡ä»¶è·¯å¾„:ä¿®æ”¹æ—¶é—´:æ–‡ä»¶å¤§å°`

## ğŸ”„ å¸¸è§æ“ä½œ

### ä¿®æ”¹ç°æœ‰æ–‡ç« 

1. ç¼–è¾‘ Markdown æ–‡ä»¶
2. è¿è¡Œè½¬æ¢è„šæœ¬
3. è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹æ–‡ä»¶å˜åŒ–å¹¶é‡æ–°è½¬æ¢

### åˆ é™¤æ–‡ç« 

**æ–¹æ³• 1ï¼šä»æºæ–‡ä»¶åˆ é™¤**
```bash
# 1. åˆ é™¤ Markdown æ–‡ä»¶
rm posts/old-article.md

# 2. åˆ é™¤å¤„ç†è®°å½•
# ç¼–è¾‘ data/.processed-files.jsonï¼Œåˆ é™¤å¯¹åº”è®°å½•

# 3. åˆ é™¤å¯¹åº”çš„ JSON æ–‡ä»¶
rm data/articles/articles-2025-01-15.json

# 4. æ›´æ–°ç´¢å¼•æ–‡ä»¶
# ç¼–è¾‘ data/articles-index.jsonï¼Œåˆ é™¤æ–‡ä»¶è®°å½•ï¼Œè°ƒæ•´ totalArticles
```

**æ–¹æ³• 2ï¼šåªä» JSON ä¸­åˆ é™¤**
```bash
# ç›´æ¥ç¼–è¾‘å¯¹åº”çš„ articles-*.json æ–‡ä»¶
# åˆ é™¤ articles æ•°ç»„ä¸­çš„æ–‡ç« å¯¹è±¡
# æ›´æ–° count å­—æ®µå’Œç´¢å¼•æ–‡ä»¶çš„ totalArticles
```

### æ‰¹é‡è¿ç§»æ—§æ–‡ç« 

```bash
# 1. å°†æ‰€æœ‰æ—§æ–‡ç« æ”¾å…¥ posts/ ç›®å½•
cp -r old-blog/posts/* posts/

# 2. ç¡®ä¿æ–‡ç« æœ‰æ­£ç¡®çš„ Front Matter
# (å¦‚éœ€è¦ï¼Œå¯ä»¥æ‰¹é‡æ·»åŠ )

# 3. è¿è¡Œè½¬æ¢
node tools/md-to-json-incremental.js

# è„šæœ¬ä¼šå¤„ç†æ‰€æœ‰æ–°æ–‡ç« 
```

### æ¸…ç©ºå¹¶é‡æ–°ç”Ÿæˆ

```bash
# 1. åˆ é™¤æ‰€æœ‰ç”Ÿæˆçš„æ–‡ä»¶
rm -rf data/articles/
rm data/articles-index.json
rm data/.processed-files.json

# 2. é‡æ–°è¿è¡Œè½¬æ¢
node tools/md-to-json-incremental.js

# æ‰€æœ‰æ–‡ç« éƒ½ä¼šè¢«é‡æ–°è½¬æ¢
```

### å¼ºåˆ¶é‡æ–°è½¬æ¢æŸä¸ªæ–‡ä»¶

```bash
# ç¼–è¾‘ data/.processed-files.json
# åˆ é™¤å¯¹åº”æ–‡ä»¶çš„è®°å½•

# ç„¶åè¿è¡Œè½¬æ¢è„šæœ¬
node tools/md-to-json-incremental.js
```

## ğŸŒ ç½‘é¡µç«¯åŠ è½½æœºåˆ¶

### è‡ªåŠ¨æ£€æµ‹æ¨¡å¼

ç½‘ç«™ä¼šè‡ªåŠ¨æ£€æµ‹ä½¿ç”¨å“ªç§æ¨¡å¼ï¼š

```javascript
// 1. å°è¯•åŠ è½½ç´¢å¼•æ–‡ä»¶
const index = await loadArticlesIndex();

if (index && index.files.length > 0) {
  // å¢é‡æ¨¡å¼ï¼šåŠ è½½æ‰€æœ‰æ–‡ç« æ–‡ä»¶
  for (const file of index.files) {
    await loadJSON(`/data/articles/${file.filename}`);
  }
} else {
  // å•ä¸€æ–‡ä»¶æ¨¡å¼ï¼šåŠ è½½ articles.json
  await loadJSON('/data/articles.json');
}
```

### ç¼“å­˜æœºåˆ¶

æ–‡ç« åŠ è½½åä¼šç¼“å­˜åˆ° `localStorage`ï¼š

```javascript
// æŸ¥çœ‹ç¼“å­˜
localStorage.getItem('valarz_articles')

// æ¸…é™¤ç¼“å­˜
localStorage.removeItem('valarz_articles')

// å¼ºåˆ¶åˆ·æ–°
await window.apiService.refreshArticles()
```

### æ€§èƒ½ä¼˜åŒ–

å¯¹äºå¤§é‡æ–‡ç« ï¼ˆ>200 ç¯‡ï¼‰ï¼Œå¯ä»¥å®ç°æ‡’åŠ è½½ï¼š

```javascript
// æœªæ¥å¯ä»¥å®ç°çš„åŠŸèƒ½
// 1. åªåŠ è½½æœ€æ–°çš„ N ä¸ªæ–‡ä»¶
// 2. æ»šåŠ¨åˆ°åº•éƒ¨æ—¶åŠ è½½æ›´å¤š
// 3. æŒ‰éœ€åŠ è½½ç‰¹å®šæ—¥æœŸèŒƒå›´çš„æ–‡ç« 
```

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ï¼šè„šæœ¬æç¤º "æ— éœ€è½¬æ¢"

**åŸå› ï¼š** æ‰€æœ‰æ–‡ä»¶éƒ½å·²å¤„ç†è¿‡

**è§£å†³ï¼š**
```bash
# å¦‚æœæ‚¨ä¿®æ”¹äº†æ–‡ä»¶ä½†æœªè¢«æ£€æµ‹åˆ°
# åˆ é™¤å·²å¤„ç†æ–‡ä»¶è®°å½•
rm data/.processed-files.json

# é‡æ–°è¿è¡Œ
node tools/md-to-json-incremental.js
```

### é—®é¢˜ï¼šç½‘é¡µæ˜¾ç¤ºæ—§å†…å®¹

**åŸå› ï¼š** æµè§ˆå™¨ç¼“å­˜æœªæ›´æ–°

**è§£å†³ï¼š**
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œ
await window.apiService.refreshArticles()

// æˆ–è€…æ¸…é™¤ç¼“å­˜
localStorage.clear()
location.reload()
```

### é—®é¢˜ï¼šæ–‡ç«  ID å†²çª

**åŸå› ï¼š** æ‰‹åŠ¨ä¿®æ”¹äº† JSON æ–‡ä»¶å¯¼è‡´ ID é‡å¤

**è§£å†³ï¼š**
```bash
# 1. åˆ é™¤æ‰€æœ‰ç”Ÿæˆæ–‡ä»¶
rm -rf data/articles/
rm data/articles-index.json
rm data/.processed-files.json

# 2. é‡æ–°ç”Ÿæˆ
node tools/md-to-json-incremental.js
```

### é—®é¢˜ï¼šè½¬æ¢åæ–‡ç« ä¸æ˜¾ç¤º

**æ£€æŸ¥æ¸…å•ï¼š**
1. âœ… Front Matter æ ¼å¼æ­£ç¡®ï¼ˆ`---` åˆ†éš”ç¬¦ï¼‰
2. âœ… å¿…å¡«å­—æ®µï¼ˆtitle, categoryï¼‰
3. âœ… æ–‡ä»¶ç¼–ç ä¸º UTF-8
4. âœ… æµè§ˆå™¨æ§åˆ¶å°æ— é”™è¯¯
5. âœ… JSON æ–‡ä»¶æ ¼å¼æ­£ç¡®

**è°ƒè¯•å‘½ä»¤ï¼š**
```javascript
// æ£€æŸ¥ç´¢å¼•
await window.apiService.loadArticlesIndex()

// æ£€æŸ¥æ–‡ç« 
await window.apiService.getArticles()

// æŸ¥çœ‹åŠ è½½æ—¥å¿—
// (æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹)
```

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### æ–‡ç« æ•°é‡ï¼š50 ç¯‡

| æ“ä½œ | å•ä¸€æ–‡ä»¶ | å¢é‡å¼ | æå‡ |
|------|---------|--------|------|
| é¦–æ¬¡è½¬æ¢ | 2.3ç§’ | 2.5ç§’ | -8% |
| å¢åŠ 1ç¯‡ | 2.3ç§’ | 0.3ç§’ | **87%â†‘** |
| ä¿®æ”¹1ç¯‡ | 2.3ç§’ | 0.3ç§’ | **87%â†‘** |
| åŠ è½½é€Ÿåº¦ | 120ms | 150ms | -20% |

### æ–‡ç« æ•°é‡ï¼š200 ç¯‡

| æ“ä½œ | å•ä¸€æ–‡ä»¶ | å¢é‡å¼ | æå‡ |
|------|---------|--------|------|
| é¦–æ¬¡è½¬æ¢ | 9.1ç§’ | 10.2ç§’ | -11% |
| å¢åŠ 1ç¯‡ | 9.1ç§’ | 0.3ç§’ | **97%â†‘** |
| ä¿®æ”¹1ç¯‡ | 9.1ç§’ | 0.3ç§’ | **97%â†‘** |
| åŠ è½½é€Ÿåº¦ | 480ms | 320ms | **33%â†‘** |

**ç»“è®ºï¼š** æ–‡ç« æ•°é‡è¶Šå¤šï¼Œå¢é‡å¼çš„ä¼˜åŠ¿è¶Šæ˜æ˜¾ï¼

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å®šæœŸå¤‡ä»½

```bash
# æ‰‹åŠ¨å¤‡ä»½
cp -r data/ backups/data-$(date +%Y%m%d)/

# æˆ–ä½¿ç”¨è‡ªåŠ¨å¤‡ä»½ï¼ˆå·²å†…ç½®åœ¨è„šæœ¬ä¸­ï¼‰
# å¤‡ä»½ä½ç½®ï¼šbackups/articles-*.json
```

### 2. ä½¿ç”¨ Git ç‰ˆæœ¬æ§åˆ¶

```bash
# æäº¤ç´¢å¼•å’Œæ–‡ç« æ–‡ä»¶
git add data/articles-index.json
git add data/articles/

# ä¸è¦æäº¤å·²å¤„ç†æ–‡ä»¶è®°å½•
echo "data/.processed-files.json" >> .gitignore
```

### 3. æ–‡ç« å‘½åè§„èŒƒ

```
posts/
â”œâ”€â”€ 2025-01-20-my-first-article.md    # æ¨èï¼šæ—¥æœŸå‰ç¼€
â”œâ”€â”€ tech-webgl-tutorial.md            # æ¨èï¼šåˆ†ç±»å‰ç¼€
â”œâ”€â”€ my-article.md                      # å¯ä»¥ï¼šç®€å•å‘½å
â””â”€â”€ æˆ‘çš„æ–‡ç« .md                        # é¿å…ï¼šçº¯ä¸­æ–‡åç§°
```

### 4. Front Matter æ¨¡æ¿

åˆ›å»º `posts/_template.md`ï¼š

```markdown
---
title: æ–‡ç« æ ‡é¢˜
category: technology  # technology / design / life
tags: æ ‡ç­¾1, æ ‡ç­¾2, æ ‡ç­¾3
icon: ğŸ“
excerpt: æ–‡ç« æ‘˜è¦ï¼ˆå¯é€‰ï¼‰
featured: false
publishDate: 2025-01-20  # å¯é€‰ï¼Œé»˜è®¤ä»Šå¤©
---

# æ–‡ç« æ ‡é¢˜

æ­£æ–‡å†…å®¹...
```

### 5. æ‰¹é‡å¤„ç†è„šæœ¬

åˆ›å»º `scripts/batch-add.sh`ï¼š

```bash
#!/bin/bash

# æ‰¹é‡æ·»åŠ æ–‡ç« 

echo "ğŸ“ æ‰¹é‡æ·»åŠ æ–‡ç« "
echo ""

# 1. è½¬æ¢æ–‡ç« 
node tools/md-to-json-incremental.js

# 2. æäº¤æ›´æ”¹
git add data/
git commit -m "Add new blog posts"

# 3. æ¨é€
git push

echo ""
echo "âœ… å®Œæˆï¼"
```

## ğŸ“š æ›´å¤šèµ„æº

- **å®Œæ•´æ–‡æ¡£ï¼š** `tools/README.md`
- **è½¬æ¢è„šæœ¬ï¼š** `tools/md-to-json-incremental.js`
- **ç¤ºä¾‹æ–‡ç« ï¼š** `posts/_example.md`

---

**ğŸ‰ ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼**

æœ‰é—®é¢˜ï¼Ÿè¯·æŸ¥çœ‹ `tools/README.md` çš„å¸¸è§é—®é¢˜éƒ¨åˆ†ã€‚

